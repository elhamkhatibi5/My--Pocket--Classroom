<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ðŸŽ“ Pocket Classroom â€” Complete Offline E-Learning</title>
<style>
/* --- Fonts & Theme --- */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
:root{
  --bg:#0f1720;
  --card:#1e293b;
  --accent:#0ea5a4;
  --muted:#9aa4b2;
  --btn-bg:#0ea5a4;
  --btn-hover:#14b8a6;
}
*{box-sizing:border-box;font-family:'Inter',sans-serif;margin:0;padding:0;}
body{background:var(--bg) url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/...') no-repeat center center fixed;background-size:cover;color:#e6eef6;}
h4,h5,h6{margin:0;}
.container{max-width:1400px;margin:auto;padding:20px;}
button{cursor:pointer;}
/* --- Layout --- */
.app-shell{display:grid;grid-template-columns:1fr 320px;gap:20px;min-height:100vh;}
.main-col{display:flex;flex-direction:column;gap:20px;}
header.navbar{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:rgba(0,0,0,0.6);border-radius:12px;}
.nav-btn{padding:6px 16px;border-radius:999px;border:1px solid var(--muted);background:transparent;color:inherit;margin-right:6px;}
.nav-btn.active{background:var(--accent);color:#fff;border:none;}
.card-panel{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.3);}
.library-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:12px;}
.capsule-card{padding:12px;border-radius:10px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);}
.muted{color:var(--muted);}
.tag{background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:999px;margin-right:4px;font-size:0.75rem;}
.btn-pill{border-radius:999px;border:none;padding:6px 12px;}
input,textarea,select{border-radius:6px;padding:6px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:#fff;width:100%;}
textarea{resize:vertical;}
.notes-panel{background:rgba(0,0,0,0.5);border-radius:12px;padding:12px;height:calc(100vh - 40px);overflow:auto;}
.learn-card{min-height:180px;}
footer{opacity:0.7;text-align:center;margin-top:12px;}
@media(max-width:900px){.app-shell{grid-template-columns:1fr;}.notes-panel{height:200px;}}
</style>
</head>
<body>
<div class="container">
<div class="app-shell">

<div class="main-col">
<!-- Header -->
<header class="navbar">
<div>
  <span style="font-weight:700;font-size:1.2rem;">ðŸŽ“ Pocket Classroom</span>
  <button class="nav-btn active" data-section="library">Library</button>
  <button class="nav-btn" data-section="author">Create</button>
  <button class="nav-btn" data-section="learn">Study</button>
</div>
<div>
  <input id="global-search" placeholder="Search..." style="width:180px;">
  <select id="sort-select" style="width:150px;">
    <option value="date-desc">Newest</option>
    <option value="date-asc">Oldest</option>
    <option value="title-asc">Title Aâ†’Z</option>
    <option value="title-desc">Title Zâ†’A</option>
  </select>
  <button id="export-all" class="btn-pill" style="background:green;">Export</button>
  <button id="import-all" class="btn-pill" style="background:gray;">Import</button>
  <input type="file" id="file-import" accept=".json" style="display:none;">
</div>
</header>

<!-- Library -->
<section id="library" class="card-panel">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
<h4>Your Library</h4><span class="muted">Capsules: <span id="capsule-count">0</span></span>
</div>
<div id="library-list" class="library-grid"></div>
<div id="empty-state" class="muted" style="margin-top:10px;">No capsules yet. Click Create to start.</div>
</section>

<!-- Create -->
<section id="author" class="card-panel" style="display:none;">
<h4>Create / Edit Capsule</h4>
<form id="capsule-form">
<input type="hidden" id="editing-index">
<div style="margin-bottom:8px;"><input id="capsule-title" placeholder="Title" required></div>
<div style="margin-bottom:8px;display:flex;gap:8px;">
<input id="capsule-tags" placeholder="Tags, comma separated">
<select id="capsule-type">
<option value="note">Note</option>
<option value="flashcards">Flashcards</option>
<option value="quiz">Quiz</option>
</select>
</div>

<div id="note-content-wrapper"><textarea id="capsule-content" rows="4" placeholder="Notes content..."></textarea></div>

<!-- Flashcards -->
<div id="flashcards-wrapper" style="display:none;margin-bottom:8px;">
<div id="flashcards-list"></div>
<div style="display:flex;gap:4px;">
<input id="fc-front" placeholder="Front">
<input id="fc-back" placeholder="Back">
<button type="button" id="add-fc" class="btn-pill" style="background:var(--accent);">Add</button>
</div>
</div>

<!-- Quiz -->
<div id="quiz-wrapper" style="display:none;margin-bottom:8px;">
<div id="quiz-list"></div>
<div style="display:flex;gap:4px;">
<input id="q-text" placeholder="Question">
<input id="q-opt1" placeholder="A">
<input id="q-opt2" placeholder="B">
</div>
<div style="display:flex;gap:4px;margin-top:4px;">
<input id="q-opt3" placeholder="C">
<input id="q-opt4" placeholder="D">
<select id="q-correct"><option value="1">A</option><option value="2">B</option><option value="3">C</option><option value="4">D</option></select>
<button type="button" id="add-q" class="btn-pill" style="background:var(--accent);">Add Q</button>
</div>
</div>

<div style="display:flex;gap:6px;margin-top:10px;">
<button type="submit" class="btn-pill" style="background:green;">Save</button>
<button type="button" id="cancel-edit" class="btn-pill" style="background:gray;">Cancel</button>
<button type="button" id="new-capsule" class="btn-pill" style="background:var(--accent);margin-left:auto;">New</button>
</div>
</form>
</section>

<!-- Study -->
<section id="learn" class="card-panel" style="display:none;">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
<h4>Study</h4><span class="muted">Mode: <span id="study-mode"></span></span>
</div>
<div style="display:flex;gap:6px;margin-bottom:8px;align-items:center;">
<select id="study-capsule-select" style="width:250px;"><option value="">Choose capsule...</option></select>
<button id="start-study" class="btn-pill" style="background:var(--accent);">Start</button>
<button id="shuffle-study" class="btn-pill" style="background:gray;">Shuffle</button>
<span class="muted" style="margin-left:auto;">Progress: <span id="study-progress">0/0</span></span>
</div>
<div id="study-area" class="learn-card card-panel" style="background:rgba(255,255,255,0.05);padding:12px;">
<div id="study-empty" class="muted">Select a capsule and press Start.</div>
<div id="flashcard-study" style="display:none;">
<div id="fc-meta" class="muted" style="font-size:0.8rem;"></div>
<div id="fc-front-display" style="font-weight:bold;font-size:1.2rem;"></div>
<div id="fc-back-display" class="muted" style="display:none;margin-top:4px;"></div>
<div style="display:flex;gap:4px;margin-top:4px;">
<button id="show-answer" class="btn-pill" style="background:gray;">Show Answer</button>
<button id="mark-learned" class="btn-pill" style="background:green;">Mark Learned</button>
<button id="next-card" class="btn-pill" style="background:var(--accent);margin-left:auto;">Next</button>
</div>
</div>
<div id="quiz-study" style="display:none;">
<div id="q-text-display" style="font-weight:bold;font-size:1.1rem;"></div>
<div id="q-options" style="display:flex;flex-direction:column;gap:4px;margin-top:4px;"></div>
<div style="display:flex;gap:4px;margin-top:4px;"><button id="q-next" class="btn-pill" style="background:var(--accent);margin-left:auto;">Next</button></div>
<div id="q-feedback" style="margin-top:4px;" class="muted"></div>
</div>
</section>

<footer>Â© 2025 Pocket Classroom â€” Offline Â· LocalStorage</footer>
</div>

<aside class="notes-panel">
<h5>Quick Notes <span class="muted" style="font-size:0.8rem;">Autosaved</span></h5>
<textarea id="notes" placeholder="Type notes..."></textarea>
<h6 style="margin-top:12px;">Recent Actions <button id="clear-logs" class="btn-pill" style="background:gray;">Clear</button></h6>
<div id="logs" style="font-size:0.8rem;margin-top:4px;"></div>
</aside>
</div>
</div>

<script>
// --- Utilities ---
function saveToStorage(){localStorage.setItem('pocketCapsules',JSON.stringify(capsules));}
function loadFromStorage(){return JSON.parse(localStorage.getItem('pocketCapsules')||'[]');}
function logAction(msg){const l=document.getElementById('logs');l.innerHTML=`<div>${msg}</div>`+l.innerHTML;}

// --- State ---
let capsules=loadFromStorage();
let currentStudyIndex=0;
let studyCards=[];
let studyMode='';

// --- Elements ---
const navBtns=document.querySelectorAll('.nav-btn');
const sections={library:document.getElementById('library'),author:document.getElementById('author'),learn:document.getElementById('learn')};
const libraryList=document.getElementById('library-list');
const capsuleCount=document.getElementById('capsule-count');
const capsuleForm=document.getElementById('capsule-form');
const editingIndex=document.getElementById('editing-index');
const notesEl=document.getElementById('notes');
const logsEl=document.getElementById('logs');
const clearLogsBtn=document.getElementById('clear-logs');

// --- Navigation ---
navBtns.forEach(btn=>{
btn.addEventListener('click',()=>{navBtns.forEach(b=>b.classList.remove('active'));btn.classList.add('active');Object.keys(sections).forEach(k=>sections[k].style.display='none');sections[btn.dataset.section].style.display='block';});
});

// --- Notes ---
notesEl.value=localStorage.getItem('pocketNotes')||'';
notesEl.addEventListener('input',()=>{localStorage.setItem('pocketNotes',notesEl.value);});

// --- Library ---
function renderLibrary(){
libraryList.innerHTML='';
if(!capsules.length){document.getElementById('empty-state').style.display='block';}
else{document.getElementById('empty-state').style.display='none';capsules.forEach((c,i)=>{
const div=document.createElement('div');div.className='capsule-card';
div.innerHTML=`<div style="font-weight:600;">${c.title}</div><div class="muted" style="font-size:0.8rem;">${c.tags.join(', ')}</div><div style="margin-top:6px;"><button onclick="editCapsule(${i})" class="btn-pill" style="background:var(--accent);">Edit</button><button onclick="deleteCapsule(${i})" class="btn-pill" style="background:red;">Delete</button></div>`;
libraryList.appendChild(div);
});}
capsuleCount.textContent=capsules.length;
updateStudySelect();
}
function editCapsule(i){const c=capsules[i];editingIndex.value=i;document.getElementById('capsule-title').value=c.title;document.getElementById('capsule-tags').value=c.tags.join(',');document.getElementById('capsule-type').value=c.type;document.getElementById('capsule-content').value=c.content||'';flashcardsWrapper.style.display=c.type==='flashcards'?'block':'none';quizWrapper.style.display=c.type==='quiz'?'block':'none';renderFlashcards(c.flashcards||[]);renderQuiz(c.quiz||[]);}
function deleteCapsule(i){if(confirm('Delete this capsule?')){capsules.splice(i,1);saveToStorage();renderLibrary();logAction(`Deleted capsule`);}}
function updateStudySelect(){const sel=document.getElementById('study-capsule-select');sel.innerHTML='<option value="">Choose capsule...</option>';capsules.forEach((c,i)=>{sel.innerHTML+=`<option value="${i}">${c.title}</option>`;});}

// --- Capsule Form ---
const flashcardsWrapper=document.getElementById('flashcards-wrapper');
const quizWrapper=document.getElementById('quiz-wrapper');
const fcListEl=document.getElementById('flashcards-list');
const quizListEl=document.getElementById('quiz-list');
document.getElementById('capsule-type').addEventListener('change',e=>{
const t=e.target.value;flashcardsWrapper.style.display=t==='flashcards'?'block':'none';quizWrapper.style.display=t==='quiz'?'block':'none';document.getElementById('note-content-wrapper').style.display=t==='note'?'block':'none';
});
function renderFlashcards(list){fcListEl.innerHTML='';list.forEach((f,i)=>{const d=document.createElement('div');d.textContent=`${f.front} â†’ ${f.back}`;fcListEl.appendChild(d);});}
function renderQuiz(list){quizListEl.innerHTML='';list.forEach((q,i)=>{const d=document.createElement('div');d.textContent=`${q.text} [${q.correct}]`;quizListEl.appendChild(d);});}

document.getElementById('add-fc').addEventListener('click',()=>{const front=document.getElementById('fc-front').value.trim();const back=document.getElementById('fc-back').value.trim();if(!front||!back)return;const idx=editingIndex.value;let cidx=idx!==''?parseInt(idx):-1;let c=cidx>=0?capsules[cidx]:{flashcards:[]};c.flashcards=c.flashcards||[];c.flashcards.push({front,back});renderFlashcards(c.flashcards);document.getElementById('fc-front').value='';document.getElementById('fc-back').value='';});
document.getElementById('add-q').addEventListener('click',()=>{const text=document.getElementById('q-text').value;const opt1=document.getElementById('q-opt1').value,opt2=document.getElementById('q-opt2').value,opt3=document.getElementById('q-opt3').value,opt4=document.getElementById('q-opt4').value;const correct=document.getElementById('q-correct').value;if(!text||!opt1||!opt2||!opt3||!opt4)return;const idx=editingIndex.value;let cidx=idx!==''?parseInt(idx):-1;let c=cidx>=0?capsules[cidx]:{quiz:[]};c.quiz=c.quiz||[];c.quiz.push({text,options:[opt1,opt2,opt3,opt4],correct});renderQuiz(c.quiz);document.getElementById('q-text').value='';document.getElementById('q-opt1').value='';document.getElementById('q-opt2').value='';document.getElementById('q-opt3').value='';document.getElementById('q-opt4').value='';});

capsuleForm.addEventListener('submit',e=>{e.preventDefault();const title=document.getElementById('capsule-title').value.trim();const tags=document.getElementById('capsule-tags').value.split(',').map(t=>t.trim()).filter(Boolean);const type=document.getElementById('capsule-type').value;let content=document.getElementById('capsule-content').value;let fc=[],q=[];if(type==='flashcards'){const idx=editingIndex.value;let cidx=idx!==''?parseInt(idx):-1;fc=(cidx>=0?capsules[cidx].flashcards:[])||[];}if(type==='quiz'){const idx=editingIndex.value;let cidx=idx!==''?parseInt(idx):-1;q=(cidx>=0?capsules[cidx].quiz:[])||[];}const data={title,tags,type,content,flashcards:fc,quiz:q};if(editingIndex.value===''){capsules.push(data);logAction(`Created capsule: ${title}`);}else{capsules[parseInt(editingIndex.value)]=data;logAction(`Updated capsule: ${title}`);}editingIndex.value='';capsuleForm.reset();flashcardsWrapper.style.display='none';quizWrapper.style.display='none';document.getElementById('note-content-wrapper').style.display='block';saveToStorage();renderLibrary();});
// --- New / Cancel ---
document.getElementById('new-capsule').addEventListener('click',()=>{
  editingIndex.value=''; capsuleForm.reset();
  flashcardsWrapper.style.display='none'; quizWrapper.style.display='none';
  document.getElementById('note-content-wrapper').style.display='block';
});
document.getElementById('cancel-edit').addEventListener('click',()=>{
  editingIndex.value=''; capsuleForm.reset();
  flashcardsWrapper.style.display='none'; quizWrapper.style.display='none';
  document.getElementById('note-content-wrapper').style.display='block';
});

// --- Export / Import ---
document.getElementById('export-all').addEventListener('click',()=>{
  const dataStr="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(capsules));
  const dlAnchor=document.createElement('a'); dlAnchor.setAttribute('href',dataStr); dlAnchor.setAttribute('download','pocket_capsules.json'); dlAnchor.click();
});
document.getElementById('import-all').addEventListener('click',()=>{document.getElementById('file-import').click();});
document.getElementById('file-import').addEventListener('change',e=>{
  const file=e.target.files[0]; if(!file)return;
  const reader=new FileReader();
  reader.onload=function(ev){try{const imported=JSON.parse(ev.target.result);if(Array.isArray(imported)){capsules=imported;saveToStorage();renderLibrary();logAction('Imported capsules.');}}catch(err){alert('Invalid JSON file');}}
  reader.readAsText(file);
});

// --- Logs ---
clearLogsBtn.addEventListener('click',()=>{logsEl.innerHTML='';});

// --- Study Mode ---
const studySelect=document.getElementById('study-capsule-select');
const startStudyBtn=document.getElementById('start-study');
const studyProgress=document.getElementById('study-progress');
const studyArea=document.getElementById('study-area');
const flashcardStudy=document.getElementById('flashcard-study');
const fcFrontDisplay=document.getElementById('fc-front-display');
const fcBackDisplay=document.getElementById('fc-back-display');
const fcMeta=document.getElementById('fc-meta');
const showAnswerBtn=document.getElementById('show-answer');
const markLearnedBtn=document.getElementById('mark-learned');
const nextCardBtn=document.getElementById('next-card');
const quizStudy=document.getElementById('quiz-study');
const qTextDisplay=document.getElementById('q-text-display');
const qOptions=document.getElementById('q-options');
const qFeedback=document.getElementById('q-feedback');
const qNextBtn=document.getElementById('q-next');

function startStudy(){
  const idx=studySelect.value; if(idx===''){alert('Select capsule'); return;}
  const capsule=capsules[idx]; currentStudyIndex=0;
  if(capsule.type==='flashcards'){studyCards=[...capsule.flashcards];studyMode='flashcards';flashcardStudy.style.display='block';quizStudy.style.display='none';fcBackDisplay.style.display='none';renderFlashcard();}
  if(capsule.type==='quiz'){studyCards=[...capsule.quiz];studyMode='quiz';flashcardStudy.style.display='none';quizStudy.style.display='block';renderQuizQuestion();}
  studyProgress.textContent=`${currentStudyIndex+1}/${studyCards.length}`;
  document.getElementById('study-mode').textContent=capsule.type;
}
function renderFlashcard(){
  if(currentStudyIndex>=studyCards.length){alert('Finished!'); return;}
  const c=studyCards[currentStudyIndex];
  fcFrontDisplay.textContent=c.front;
  fcBackDisplay.textContent=c.back;
  fcBackDisplay.style.display='none';
  fcMeta.textContent=`Card ${currentStudyIndex+1}/${studyCards.length}`;
  studyProgress.textContent=`${currentStudyIndex+1}/${studyCards.length}`;
}
showAnswerBtn.addEventListener('click',()=>{fcBackDisplay.style.display='block';});
markLearnedBtn.addEventListener('click',()=>{studyCards.splice(currentStudyIndex,1);if(currentStudyIndex>=studyCards.length)currentStudyIndex=0;renderFlashcard();});
nextCardBtn.addEventListener('click',()=>{currentStudyIndex=(currentStudyIndex+1)%studyCards.length;renderFlashcard();});

function renderQuizQuestion(){
  if(currentStudyIndex>=studyCards.length){alert('Finished!'); return;}
  const q=studyCards[currentStudyIndex];
  qTextDisplay.textContent=q.text;
  qOptions.innerHTML='';
  q.options.forEach((opt,i)=>{const btn=document.createElement('button'); btn.className='btn-pill'; btn.textContent=opt; btn.style.background='rgba(255,255,255,0.1)'; btn.addEventListener('click',()=>{qFeedback.textContent=(i+1==q.correct)?'Correct!':'Wrong!';}); qOptions.appendChild(btn);});
  qFeedback.textContent='';
  studyProgress.textContent=`${currentStudyIndex+1}/${studyCards.length}`;
}
qNextBtn.addEventListener('click',()=>{currentStudyIndex=(currentStudyIndex+1)%studyCards.length;renderQuizQuestion();});
startStudyBtn.addEventListener('click',startStudy);
document.getElementById('shuffle-study').addEventListener('click',()=>{studyCards.sort(()=>Math.random()-0.5);currentStudyIndex=0;if(studyMode==='flashcards')renderFlashcard();if(studyMode==='quiz')renderQuizQuestion();});

// --- Initialize ---
renderLibrary();
</script>
</body>
</html>
