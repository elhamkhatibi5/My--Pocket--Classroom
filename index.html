<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“ Pocket Classroom â€” Ø¢ÙÙ„Ø§ÛŒÙ†</title>
<style>
/* --- Reset & Base --- */
* {margin:0;padding:0;box-sizing:border-box;font-family:sans-serif;}
body {background:#f0f4f8; color:#111; min-height:100vh;}
button {cursor:pointer; transition:0.2s;}
button:hover {opacity:0.8;}

/* --- Navbar --- */
nav {display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:#0ea5a4;color:#fff;}
nav h1 {font-size:1.5rem;}
nav .nav-buttons button {margin-left:0.5rem;padding:0.4rem 0.8rem;border:none;border-radius:5px;background:#06b6d4;color:#fff;}

/* --- Main Layout --- */
.container {display:flex;gap:1rem;padding:1rem;}
.library, .study, .capsule-form {background:#fff;padding:1rem;border-radius:10px;flex:1;box-shadow:0 4px 8px rgba(0,0,0,0.1);}
.library h2, .study h2, .capsule-form h2 {margin-bottom:0.5rem;}

/* --- Capsule List --- */
.capsule-item {padding:0.5rem; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;}
.capsule-item:last-child {border:none;}
.capsule-item button {padding:0.2rem 0.5rem;background:#0ea5a4;color:#fff;border:none;border-radius:4px;font-size:0.8rem;}

/* --- Flashcards & Quiz --- */
.flashcard, .quiz {margin-top:1rem;padding:1rem;border:1px solid #ddd;border-radius:8px;background:#f9fafb;}
.flashcard div {margin-bottom:0.5rem;}
#fc-front-display,#fc-back-display,#q-text-display {font-weight:bold;font-size:1.1rem;margin-bottom:0.5rem;}
.btn-pill {margin:0.2rem;padding:0.4rem 0.8rem;border:none;border-radius:20px;background:rgba(14,165,164,0.2);color:#111;}

/* --- Forms --- */
.capsule-form input, .capsule-form textarea, .capsule-form select {width:100%;margin-bottom:0.5rem;padding:0.4rem;border:1px solid #ccc;border-radius:5px;}
.capsule-form button {background:#0ea5a4;color:#fff;border:none;padding:0.5rem 1rem;border-radius:5px;margin-top:0.5rem;}
</style>
</head>
<body>

<nav>
  <h1>ğŸ“ Pocket Classroom</h1>
  <div class="nav-buttons">
    <button id="new-capsule">Ú©Ù¾Ø³ÙˆÙ„ Ø¬Ø¯ÛŒØ¯</button>
    <button id="export-all">Export</button>
    <button id="import-all">Import</button>
    <input type="file" id="file-import" style="display:none">
  </div>
</nav>

<div class="container">
  <!-- Library -->
  <div class="library">
    <h2>Library</h2>
    <div id="capsule-list"></div>
  </div>

  <!-- Study Area -->
  <div class="study">
    <h2>Study Mode</h2>
    <select id="study-capsule-select">
      <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù¾Ø³ÙˆÙ„</option>
    </select>
    <button id="start-study">Ø´Ø±ÙˆØ¹ Ù…Ø·Ø§Ù„Ø¹Ù‡</button>
    <button id="shuffle-study">Shuffle</button>
    <div id="study-progress"></div>

    <!-- Flashcard -->
    <div class="flashcard" id="flashcard-study" style="display:none">
      <div id="fc-front-display"></div>
      <div id="fc-back-display" style="display:none"></div>
      <div id="fc-meta"></div>
      <button id="show-answer">Ù†Ù…Ø§ÛŒØ´ Ø¬ÙˆØ§Ø¨</button>
      <button id="mark-learned">ÛŒØ§Ø¯Ú¯Ø±ÙØªÙ‡</button>
      <button id="next-card">Ø¨Ø¹Ø¯ÛŒ</button>
    </div>

    <!-- Quiz -->
    <div class="quiz" id="quiz-study" style="display:none">
      <div id="q-text-display"></div>
      <div id="q-options"></div>
      <div id="q-feedback" style="margin-top:0.5rem;font-weight:bold;"></div>
      <button id="q-next">Ø¨Ø¹Ø¯ÛŒ</button>
    </div>
  </div>

  <!-- Capsule Form -->
  <div class="capsule-form">
    <h2>Ø§ÛŒØ¬Ø§Ø¯ / ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù¾Ø³ÙˆÙ„</h2>
    <input type="text" id="capsule-title" placeholder="Ø¹Ù†ÙˆØ§Ù†">
    <input type="text" id="capsule-tags" placeholder="ØªÚ¯â€ŒÙ‡Ø§ (Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ø´ÙˆØ¯)">
    <select id="capsule-type">
      <option value="note">Note</option>
      <option value="flashcards">Flashcards</option>
      <option value="quiz">Quiz</option>
    </select>
    <textarea id="capsule-content" rows="3" placeholder="Ù…Ø­ØªÙˆØ§"></textarea>

    <div id="flashcards-wrapper" style="display:none">
      <h3>ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øªâ€ŒÙ‡Ø§</h3>
      <div id="flashcards-list"></div>
      <input type="text" id="fc-front" placeholder="Front">
      <input type="text" id="fc-back" placeholder="Back">
      <button id="add-flashcard">Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª</button>
    </div>

    <div id="quiz-wrapper" style="display:none">
      <h3>Ú©ÙˆÛŒÛŒØ²</h3>
      <div id="quiz-list"></div>
      <input type="text" id="q-text" placeholder="Ø³ÙˆØ§Ù„">
      <input type="text" id="q-opt1" placeholder="Ú¯Ø²ÛŒÙ†Ù‡ 1">
      <input type="text" id="q-opt2" placeholder="Ú¯Ø²ÛŒÙ†Ù‡ 2">
      <input type="text" id="q-opt3" placeholder="Ú¯Ø²ÛŒÙ†Ù‡ 3">
      <input type="text" id="q-opt4" placeholder="Ú¯Ø²ÛŒÙ†Ù‡ 4">
      <input type="number" id="q-correct" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ú¯Ø²ÛŒÙ†Ù‡ ØµØ­ÛŒØ­ (1-4)">
      <button id="add-quiz">Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø³ÙˆØ§Ù„</button>
    </div>

    <button id="save-capsule">Ø°Ø®ÛŒØ±Ù‡ Ú©Ù¾Ø³ÙˆÙ„</button>
    <button id="cancel-edit">Ù„ØºÙˆ</button>
  </div>
</div>

<script type="module">
// --- Storage ---
let capsules = [];
function saveToStorage(){localStorage.setItem('pocketCapsules',JSON.stringify(capsules));}
function loadFromStorage(){const data=localStorage.getItem('pocketCapsules');if(data) capsules=JSON.parse(data);}
loadFromStorage();

// --- State ---
let tempFlashcards = [];
let tempQuiz = [];
let editingIndex = '';
let studyCards = [];
let currentStudyIndex = 0;
let studyMode = '';

// --- Elements ---
const capsuleForm=document.querySelector('.capsule-form');
const flashcardsWrapper=document.getElementById('flashcards-wrapper');
const quizWrapper=document.getElementById('quiz-wrapper');
const capsuleList=document.getElementById('capsule-list');
const studySelect=document.getElementById('study-capsule-select');
const startStudyBtn=document.getElementById('start-study');
const studyProgress=document.getElementById('study-progress');
const flashcardStudy=document.getElementById('flashcard-study');
const fcFrontDisplay=document.getElementById('fc-front-display');
const fcBackDisplay=document.getElementById('fc-back-display');
const fcMeta=document.getElementById('fc-meta');
const showAnswerBtn=document.getElementById('show-answer');
const markLearnedBtn=document.getElementById('mark-learned');
const nextCardBtn=document.getElementById('next-card');
const quizStudy=document.getElementById('quiz-study');
const qTextDisplay=document.getElementById('q-text-display');
const qOptions=document.getElementById('q-options');
const qFeedback=document.getElementById('q-feedback');
const qNextBtn=document.getElementById('q-next');

// --- Initialize Sample Capsules ---
function initSampleCapsules(){
  capsules = [
    {
      title:"Ø±ÛŒØ§Ø¶ÛŒ Ù¾Ø§ÛŒÙ‡",
      tags:"math,algebra",
      type:"flashcards",
      content:"",
      flashcards:[
        {front:"Ø¬Ù…Ø¹ Û²+Û²",back:"Û´"},
        {front:"ØªÙØ±ÛŒÙ‚ Ûµ-Û³",back:"Û²"},
        {front:"Ø¶Ø±Ø¨ Û³Ã—Û³",back:"Û¹"},
        {front:"ØªÙ‚Ø³ÛŒÙ… Û¸Ã·Û²",back:"Û´"},
        {front:"ØªÙˆØ§Ù† Û²Â³",back:"Û¸"}
      ],
      quiz:[]
    },
    {
      title:"Ø¹Ù„ÙˆÙ… Ù¾Ø§ÛŒÙ‡",
      tags:"science,physics",
      type:"quiz",
      content:"",
      flashcards:[],
      quiz:[
        {text:"Ù†ÛŒØ±ÙˆÛŒ Ú¯Ø±Ø§Ù†Ø´ Ø²Ù…ÛŒÙ† Ú†ÛŒØ³ØªØŸ",options:["Û±Û°N","Û¹.Û¸m/sÂ²","100kg","5m/sÂ²"],correct:2},
        {text:"Ø§ØªÙ…Ø³ÙØ± Ú†ÛŒØ³ØªØŸ",options:["Ù‡ÙˆØ§","Ø¢Ø¨","Ø®Ø§Ú©","Ø³Ù†Ú¯"],correct:1},
        {text:"Ù†ÙˆØ± Ø¨Ø§ Ú†Ù‡ Ø³Ø±Ø¹ØªÛŒ Ø­Ø±Ú©Øª Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ",options:["3Ã—10â¸ m/s","5Ã—10â¸","10Â³","1500m/s"],correct:1}
      ]
    },
    {
      title:"Ø²Ø¨Ø§Ù† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ",
      tags:"english,vocabulary",
      type:"flashcards",
      content:"",
      flashcards:[
        {front:"Hello",back:"Ø³Ù„Ø§Ù…"},
        {front:"Thank you",back:"Ù…ØªØ´Ú©Ø±Ù…"},
        {front:"Good morning",back:"ØµØ¨Ø­ Ø¨Ø®ÛŒØ±"},
        {front:"Good night",back:"Ø´Ø¨ Ø¨Ø®ÛŒØ±"},
        {front:"Please",back:"Ù„Ø·ÙØ§Ù‹"}
      ],
      quiz:[]
    },
    {
      title:"ØªØ§Ø±ÛŒØ®",
      tags:"history",
      type:"quiz",
      content:"",
      flashcards:[],
      quiz:[
        {text:"Ú†Ù‡ Ú©Ø³ÛŒ Ø§Ø¹Ù„Ø§Ù…ÛŒÙ‡ Ø§Ø³ØªÙ‚Ù„Ø§Ù„ Ø±Ø§ Ø§Ù…Ø¶Ø§ Ú©Ø±Ø¯ØŸ",options:["Ø¬ÙˆØ±Ø¬ ÙˆØ§Ø´Ù†Ú¯ØªÙ†","ØªÙˆÙ…Ø§Ø³ Ø¬ÙØ±Ø³ÙˆÙ†","Ø¢Ø¨Ø±Ø§Ù‡Ø§Ù… Ù„ÛŒÙ†Ú©Ù„Ù†","Ø¨Ù†Ø¬Ø§Ù…ÛŒÙ† ÙØ±Ø§Ù†Ú©Ù„ÛŒÙ†"],correct:2},
        {text:"Ø³Ø§Ù„ Ø´Ø±ÙˆØ¹ Ø¬Ù†Ú¯ Ø¬Ù‡Ø§Ù†ÛŒ Ø¯ÙˆÙ…ØŸ",options:["1939","1914","1945","1920"],correct:1}
      ]
    },
    {
      title:"Ø²ÛŒØ³Øªâ€ŒØ´Ù†Ø§Ø³ÛŒ",
      tags:"biology",
      type:"flashcards",
      content:"",
      flashcards:[
        {front:"Ø¨Ø²Ø±Ú¯â€ŒØªØ±ÛŒÙ† Ø§Ù†Ø¯Ø§Ù… Ø¨Ø¯Ù†",back:"Ù¾ÙˆØ³Øª"},
        {front:"Ø³Ù„ÙˆÙ„ Ù¾Ø§ÛŒÙ‡ Ù‡Ù…Ù‡ Ù…ÙˆØ¬ÙˆØ¯Ø§Øª",back:"Ø³Ù„ÙˆÙ„"},
        {front:"Ù…Ø­Ù„ ØªÙˆÙ„ÛŒØ¯ Ø§Ù†Ø±Ú˜ÛŒ Ø³Ù„ÙˆÙ„",back:"Ù…ÛŒØªÙˆÚ©Ù†Ø¯Ø±ÛŒ"},
        {front:"Ù…ÙˆÙ„Ú©ÙˆÙ„ Ø­Ø§Ù…Ù„ Ú˜Ù†",back:"DNA"},
        {front:"Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø±ÛŒÙ‡â€ŒÙ‡Ø§",back:"ØªÙ†ÙØ³"}
      ],
      quiz:[]
    }
  ];
  saveToStorage();
}
if(capsules.length===0) initSampleCapsules();

// --- Render Library ---
function renderLibrary(){
  capsuleList.innerHTML='';
  studySelect.innerHTML='<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù¾Ø³ÙˆÙ„</option>';
  capsules.forEach((c,i)=>{
    const div=document.createElement('div');
    div.className='capsule-item';
    div.innerHTML=`<span>${c.title}</span>
    <div>
      <button onclick="editCapsule(${i})">ÙˆÛŒØ±Ø§ÛŒØ´</button>
      <button onclick="deleteCapsule(${i})">Ø­Ø°Ù</button>
    </div>`;
    capsuleList.appendChild(div);
    const opt=document.createElement('option');
    opt.value=i;
    opt.textContent=c.title;
    studySelect.appendChild(opt);
  });
}
window.renderLibrary=renderLibrary;

// --- Capsule CRUD ---
window.editCapsule=function(idx){
  const c=capsules[idx];
  document.getElementById('capsule-title').value=c.title;
  document.getElementById('capsule-tags').value=c.tags;
  document.getElementById('capsule-type').value=c.type;
  document.getElementById('capsule-content').value=c.content;
  editingIndex=idx;
  tempFlashcards=[...c.flashcards];
  tempQuiz=[...c.quiz];
  flashcardsWrapper.style.display=c.type==='flashcards'?'block':'none';
  quizWrapper.style.display=c.type==='quiz'?'block':'none';
};
window.deleteCapsule=function(idx){
  if(confirm('Ø­Ø°Ù Ø´ÙˆØ¯ØŸ')){capsules.splice(idx,1);saveToStorage();renderLibrary();}
};

// --- Form Interactions ---
document.getElementById('capsule-type').addEventListener('change',e=>{
  flashcardsWrapper.style.display=e.target.value==='flashcards'?'block':'none';
  quizWrapper.style.display=e.target.value==='quiz'?'block':'none';
});
document.getElementById('add-flashcard').addEventListener('click',()=>{
  const f=document.getElementById('fc-front').value;
  const b=document.getElementById('fc-back').value;
  if(f&&b){tempFlashcards.push({front:f,back:b});document.getElementById('fc-front').value='';document.getElementById('fc-back').value='';renderFlashcardsList();}
});
document.getElementById('add-quiz').addEventListener('click',()=>{
  const t=document.getElementById('q-text').value;
  const o1=document.getElementById('q-opt1').value;
  const o2=document.getElementById('q-opt2').value;
  const o3=document.getElementById('q-opt3').value;
  const o4=document.getElementById('q-opt4').value;
  const c=parseInt(document.getElementById('q-correct').value);
  if(t&&o1&&o2&&o3&&o4&&[1,2,3,4].includes(c)){
    tempQuiz.push({text:t,options:[o1,o2,o3,o4],correct:c});
    document.getElementById('q-text').value='';document.getElementById('q-opt1').value='';document.getElementById('q-opt2').value='';document.getElementById('q-opt3').value='';document.getElementById('q-opt4').value='';document.getElementById('q-correct').value='';renderQuizList();
  }
});

function renderFlashcardsList(){/*optional: show temp flashcards*/ }
function renderQuizList(){/*optional: show temp quiz*/ }

document.getElementById('save-capsule').addEventListener('click',()=>{
  const title=document.getElementById('capsule-title').value;
  const tags=document.getElementById('capsule-tags').value;
  const type=document.getElementById('capsule-type').value;
  const content=document.getElementById('capsule-content').value;
  const data={title,tags,type,content,flashcards:type==='flashcards'?tempFlashcards:[],quiz:type==='quiz'?tempQuiz:[]};
  if(editingIndex===''){capsules.push(data);}else{capsules[editingIndex]=data;}
  saveToStorage();editingIndex='';capsuleForm.reset();flashcardsWrapper.style.display='none';quizWrapper.style.display='none';renderLibrary();
});
document.getElementById('cancel-edit').addEventListener('click',()=>{editingIndex='';capsuleForm.reset();flashcardsWrapper.style.display='none';quizWrapper.style.display='none';});

// --- Study Mode ---
function startStudy(){
  const idx=studySelect.value; 
  if(idx===''){alert('Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');return;}
  const capsule=capsules[idx]; currentStudyIndex=0;
  if(capsule.type==='flashcards'){studyCards=[...capsule.flashcards];studyMode='flashcards';flashcardStudy.style.display='block';quizStudy.style.display='none';fcBackDisplay.style.display='none';renderFlashcard();}
  if(capsule.type==='quiz'){studyCards=[...capsule.quiz];studyMode='quiz';flashcardStudy.style.display='none';quizStudy.style.display='block';renderQuizQuestion();}
  studyProgress.textContent=`${currentStudyIndex+1}/${studyCards.length}`;
}
startStudyBtn.addEventListener('click',startStudy);
document.getElementById('shuffle-study').addEventListener('click',()=>{
  studyCards.sort(()=>Math.random()-0.5);currentStudyIndex=0;
  if(studyMode==='flashcards') renderFlashcard(); if(studyMode==='quiz') renderQuizQuestion();
});

function renderFlashcard(){
  if(studyCards.length===0){fcFrontDisplay.textContent='Ú©Ø§Ø±Øª Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª'; fcBackDisplay.style.display='none';return;}
  if(currentStudyIndex>=studyCards.length){alert('ØªÙ…Ø§Ù… Ø´Ø¯');return;}
  const c=studyCards[currentStudyIndex];
  fcFrontDisplay.textContent=c.front;
  fcBackDisplay.textContent=c.back;
  fcBackDisplay.style.display='none';
  fcMeta.textContent=`Card ${currentStudyIndex+1}/${studyCards.length}`;
  studyProgress.textContent=`${currentStudyIndex+1}/${studyCards.length}`;
}
showAnswerBtn.addEventListener('click',()=>{fcBackDisplay.style.display='block';});
markLearnedBtn.addEventListener('click',()=>{
  studyCards.splice(currentStudyIndex,1);
  if(currentStudyIndex>=studyCards.length) currentStudyIndex=0;
  renderFlashcard();
});
nextCardBtn.addEventListener('click',()=>{
  if(studyCards.length===0) return;
  currentStudyIndex=(currentStudyIndex+1)%studyCards.length;
  renderFlashcard();
});

function renderQuizQuestion(){
  if(studyCards.length===0){qTextDisplay.textContent='Ú©ÙˆÛŒÛŒØ² Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª'; qOptions.innerHTML=''; return;}
  if(currentStudyIndex>=studyCards.length){alert('ØªÙ…Ø§Ù…Ø´Ø¯'); return;}
  const q = studyCards[currentStudyIndex];
  qTextDisplay.textContent = q.text;
  qOptions.innerHTML = '';
  q.options.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'btn-pill';
    btn.textContent = opt;
    btn.addEventListener('click', () => {
      qFeedback.textContent = (i + 1 === q.correct) ? 'ØµØ­ÛŒØ­!' : 'ØºÙ„Ø·!';
    });
    qOptions.appendChild(btn);
  });
  qFeedback.textContent = '';
  studyProgress.textContent = `${currentStudyIndex + 1}/${studyCards.length}`;
}

qNextBtn.addEventListener('click', () => {
  if(studyCards.length === 0) return;
  currentStudyIndex = (currentStudyIndex + 1) % studyCards.length;
  renderQuizQuestion();
});

// --- Export / Import ---
document.getElementById('export-all').addEventListener('click', () => {
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(capsules));
  const dlAnchor = document.createElement('a');
  dlAnchor.setAttribute('href', dataStr);
  dlAnchor.setAttribute('download', 'pocket_capsules.json');
  dlAnchor.click();
});

document.getElementById('import-all').addEventListener('click', () => {
  document.getElementById('file-import').click();
});

document.getElementById('file-import').addEventListener('change', e => {
  const file = e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    try {
      const imported = JSON.parse(ev.target.result);
      if(Array.isArray(imported)) {
        capsules = imported; saveToStorage(); renderLibrary();
        alert('Ú©Ù¾Ø³ÙˆÙ„â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù†Ø¯!');
      }
    } catch(err) {
      alert('ÙØ§ÛŒÙ„ JSON Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª!');
    }
  }
  reader.readAsText(file);
});

// --- Initialize ---
renderLibrary();

</script>
</body>
</html>


                                                 
